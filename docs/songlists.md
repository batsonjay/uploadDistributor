# Songlists

This document defines the structure, normalization, and storage of songlist files used in the Upload Distributor project.

## Purpose

Most Songlist files will be associated with pre-recorded `.mp3` files that are uploaded by a DJ and sent to Azuracast for future broadcast. In some cases, the upload has the same purpose but which were broadcast in the past.

Songlists accompany each `.mp3` upload and describe the information associated broadcast (called "Broadcast Data" here) plus a list of the songs played in the broadcast (called the "Track List" here).

Broadcast Data is collected from the DJ when they use the client to upload a .mp3 file. A DJ attaches a Track List data file in the same upload of the .mp3 file.

## Anticipated Track List File Formats 

The Track List data will arrive in one of several forms:
- A `.nml` file, containing structured information, generated by the Traktor Pro DJ software
- A plain text or .docx file containing semi-structured text, generated manually by the DJ

Code will eventually need written to normalize all these into the JSON format to be used to store the complete Songlist file.

## Normalization Rules

- All Songlist must include the following information about the broadcast:
  - `broadcast_date` (in `YYYY-MM-DD` format)
  - `broadcast_time` (in `HH:MM:SS` format)
  - `DJ`
  - `setTitle`
  - `duration`
  - `genre` (from the approved list of genres, see below)
  - `tags` (array of keywords related to the content)
  - `artwork` (path or URL to the cover image)
  - `description` (detailed description of the broadcast)

- All Track List data must include:
  - `title`
  - `artist`

- Timestamps are validated and normalized to a consistent format.
- Artist/title capitalization is standardized, as is any "feat." notation (which is often included when a track title indicated a "featured" artist)

## Approved Genres

The following is the approved list of genres that can be used in the `genre` field. These genres are based on the Mixcloud "charts" from the House subcategory, plus Techno:

- Acid House
- Afro House
- Bass House
- Chicago House
- Deep House
- Electro House
- Funky House
- Future House
- Garage House
- Hard House
- Jackin House
- Latin House
- Melodic House
- Minimal House
- Progressive House
- Soulful House
- Tech House
- Tribal House
- Vocal House
- Techno

This restricted list ensures compatibility with Mixcloud's genre categorization system and will be used for both Mixcloud and SoundCloud uploads.

## Example (JSON)

```json
{
  "broadcast_data": {
    "broadcast_date": "2025-05-04",
    "broadcast_time": "20:00:00",
    "DJ": "Test DJ",
    "setTitle": "Deep House Sessions Vol. 42",
    "duration": "02:00:00",
    "genre": "Deep House",
    "tags": ["electronic", "house", "deep", "melodic"],
    "artwork": "artwork.jpg",
    "description": "A journey through the deeper sounds of house music, featuring new releases and classic tracks."
  },
  "track_list": [
    {
      "title": "Underwater Love",
      "artist": "Deep Dive"
    },
    {
      "title": "Midnight Groove",
      "artist": "Luna Waves"
    },
    {
      "title": "Echoes of You",
      "artist": "Soulful Strings feat. Vocal Harmony"
    },
    {
      "title": "Ocean Floor",
      "artist": "Aquatic Sounds"
    },
    {
      "title": "Distant Memories",
      "artist": "Nostalgic Beats"
    }
  ],
  "platform_specific": {
    "mixcloud": {
      "tags": ["deep house", "electronic", "dj mix"],
      "publish_date": "2025-05-05T12:00:00Z"
    },
    "soundcloud": {
      "sharing": "public",
      "license": "cc-by-nc-sa"
    }
  },
  "user_role": "DJ",
  "version": "1.0"
}
```

## Persistent Storage

- Songlists are stored persistently by the daemon.
- Storage format: JSON
- Storage location: Local filesystem, with a directory per-DJ
- Each songlist is associated with a unique upload ID

## Usage

- Track List files are parsed and validated during upload processing.
- Used to populate tracklists on Mixcloud and AzuraCast.
- Not used by SoundCloud (but retained for consistency).

## Versioning

- Songlist schema may evolve.
- Version field may be added to support backward compatibility.
